<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora</title>
    <style>
        /* Importando fontes do Google Fonts */
        @import url('https://fonts.googleapis.com/css2?family=Jura:wght@300..700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap');

        /* Resetando estilos padrões para garantir um layout consistente */
        * {
            margin: 0;
            /* Remove margens padrão */
            padding: 0;
            /* Remove espaçamentos padrão */
            box-sizing: border-box;
            /* Faz com que o padding e a borda sejam incluídos no tamanho total do elemento */
            font-family: "Montserrat", sans-serif;
            /* Define a fonte padrão */
        }

        /* Container principal */
        .container-pai-pai {
            text-align: center;
            /* Centraliza o texto dentro do container */
            height: max-content;
            /* Ajusta a altura ao conteúdo */
            background-color: #bee7ff50;
            /* Define uma cor de fundo */
            gap: 2rem;
            /* Define um espaçamento entre os elementos */
        }

        /* Alinhando a calculadora ao centro da tela */
        .container-pai {
            display: flex;
            /* Ativa o flexbox para alinhamento (modo mais eficiente para criar layout) */
            justify-content: center;
            /* Centraliza os elementos horizontalmente */
            align-items: center;
            /* Centraliza os elementos verticalmente */
            height: 100vh;
            /* Ocupa toda a altura da tela */
            gap: 2rem;
            /* Espaçamento entre os elementos */
        }

        /* Estilizando a div da calculadora */
        .container {
            display: flex;
            /* Ativa o flexbox */
            flex-direction: column;
            /* Organiza os elementos em coluna */
            background: white;
            /* Define o fundo branco */
            padding: 20px;
            /* Adiciona espaçamento interno */
            border-radius: 10px;
            /* Arredonda as bordas */
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);
            /* Adiciona sombra ao redor */
            text-align: center;
            /* Centraliza o texto */
            width: 500px;
            /* Define a largura fixa */
            gap: 1.5rem;
            /* Espaçamento entre os elementos internos */
        }

        /* Estilizando a caixa de resposta */
        #div_resp {
            display: flex;
            /* Ativa o flexbox */
            flex-direction: column;
            /* Organiza os elementos em coluna */
            background: white;
            /* Define o fundo branco */
            padding: 20px;
            /* Adiciona espaçamento interno */
            border-radius: 10px;
            /* Arredonda as bordas */
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);
            /* Adiciona sombra ao redor */
            text-align: center;
            /* Centraliza o texto */
            width: 500px;
            /* Define uma largura fixa */
        }

        /* Estilizando a div da calculadora */
        .container-inad {
            display: flex;
            /* Ativa o flexbox */
            flex-direction: column;
            /* Organiza os elementos em coluna */
            gap: 1.5rem;
            /* Espaçamento entre os elementos internos */
        }

        /* Criando uma barra azul antes da div */
        .container-inad::before {
            content: "";
            /* Conteúdo vazio, necessário para existir visualmente */
            border: 1px solid #9AD8FD;
            /* Cria uma borda azul */
            width: 300px;
            /* Define a largura da linha */
            align-self: center;
            /* Centraliza a linha horizontalmente */
        }

        /* Estilizando título h1 */
        h1 {
            font-family: "Jura", sans-serif;
            /* Define a fonte específica */
            font-weight: bold;
            /* Deixa o texto em negrito */
        }

        /* Estilizando input de entrada */
        input {
            padding: 10px;
            /* Adiciona espaçamento interno */
            border-radius: 5px;
            /* Arredonda as bordas */
            border: 1px solid gray;
            /* Adiciona uma borda cinza */
        }

        /* Estilizando botão */
        button {
            padding: 10px;
            /* Adiciona espaçamento interno */
            border-radius: 5px;
            /* Arredonda as bordas */
            border: 1px solid #85cffa;
            /* Adiciona uma borda azul clara */
            background-color: #5DD7ED;
            /* Define a cor de fundo azul */
        }

        /* Mudando a aparência ao passar o mouse sobre o botão */
        button:hover {
            background-color: rgb(62, 181, 250);
            /* Muda a cor de fundo */
            cursor: pointer;
            /* Muda o cursor para indicar clique */
        }

        /* Estilizando elementos span */
        span {
            color: gray;
            /* Define a cor do texto */
        }

        /* Adicionando espaçamento na resposta */
        #div_resp {
            gap: 10px;
            /* Adiciona espaçamento entre os elementos */
        }
    </style>
</head>

<body>
    <div class="container-pai-pai">
        <H1>Calcule a sua possível perda</H1>
        <div class="container-pai">
            <div class="container">
                <input type="text" id="ipt_carneInfo" placeholder="Insira a carne do lote...">
                <input type="number" id="ipt_carneQnt" placeholder="Insira a quantidade de carne (kg)...">
                <input type="number" id="ipt_precoV" placeholder="Insira o preço de venda da carne...">
                <input type="number" id="ipt_precoC" placeholder="Insira o preço pelo qual foi comprado a carne...">
                <div class="container-inad">
                    <input type="number" id="ipt_temp" placeholder="Insira a temperatura que a carne ficou...">
                    <input type="number" id="ipt_hora"
                        placeholder="Insira a quantidade de horas que a carne ficou nessa temperatura...">
                </div>
                <button onclick="Calcular()">Calcular perda</button>
            </div>
            <div id="div_resp"><span>Esperando dados...</span></div>
        </div>
    </div>
</body>
<script>
    var perda = 0;
    var lucro = 0;
    var lucroPerda = lucro * perda;
    var lucroAfetado = lucro - lucroPerda;


    function Calcular() {
        var carne = (ipt_carneInfo.value);
        var carneQnt = Number(ipt_carneQnt.value);
        var temperatura = Number(ipt_temp.value);
        var horas = Number(ipt_hora.value);
        var vendas = Number(ipt_precoV.value);
        var compras = Number(ipt_precoC.value);
        var perdaVendas = 0
        var perdaCompras = 0
        var receitaBruta = carneQnt * vendas
        var custoCompra = carneQnt * compras
        lucro = receitaBruta - custoCompra;
        // Máxima temperatura segura 4ºC
        // Mínima temperatura segura -3 para refrigeração, dps ela congela

        if (temperatura >= -3 && temperatura <= 4) {
            div_resp.innerHTML = `<p>O lote de ${carne} não sofrerá perdas dentro de 12 meses</p>`;
        }

        if (temperatura >= 4) {
            if (horas >= 0 && horas <= 2) {
                var tempoRest = 2 - horas;
                perda = 0;
                div_resp.innerHTML = ` <p>O lote de ${carne} não sofrerá perdas dentro de ${tempoRest} horas</p>`;
            } else if (horas <= 4) {
                perda = 0.02;
            } else if (horas <= 8) {
                perda = 0.1;
            } else if (horas <= 12) {
                perda = 0.2;
            } else if (horas <= 24) {
                perda = 0.35;
            } else {
                perda = 0.5;
            }
        } else if (temperatura < -3) {
            if (horas >= 0 && horas <= 2) {
                var tempoRest = 2 - horas;
                console.log(tempoRest);
                perda = 0;
                div_resp.innerHTML = ` <p>O lote de ${carne} não sofrerá perdas dentro de ${tempoRest} horas</p>`;
            } else if (horas <= 23) {
                perda = 0.03;
            } else if (horas <= 47) {
                perda = 0.07;
            } else {
                perda = 0.15;
            }
        }

        if (perda > 0) {
            perdaVendas = perda * vendas
            perdaCarne = (vendas - perdaVendas) * carneQnt
            lucroPerda = perdaCarne - custoCompra;
            lucroAfetado = lucro - lucroPerda;

            div_resp.innerHTML = `<p><b>Cada carne custará R$${perdaVendas.toFixed(2)} a menos na venda para o consumidor.
                    Resultando em uma perda de R$${lucroAfetado.toFixed(2)} no lucro final.</b></p>`;

            if (perda === 0.5) {
                lucroAfetado = custoCompra
                div_resp.innerHTML = `<p><b>O lote de ${carne} não poderá mais ser comercializado,
                    podendo ir apenas para processamento ou apenas será descartado. <br>
                    Resultando em uma perda total de <span style="color: red;">R$${lucroAfetado}.</span></b> <br>`;
            }

            if (perda === 0.15) {
                div_resp.innerHTML += `<p><b><p>O lote de ${carne} poderá ir para o uso industrial (imbutidos ou moída)</p></b> <br>`;
            }

            div_resp.innerHTML += `<button id="botaoDiv" onclick="VerMais()">Ver Mais</button>`;
        }
    }

    function VerMais() {
        var carne = (ipt_carneInfo.value);
        var carneQnt = Number(ipt_carneQnt.value);
        var temperatura = Number(ipt_temp.value);
        var horas = Number(ipt_hora.value);
        var vendas = Number(ipt_precoV.value);
        var compras = Number(ipt_precoC.value);
        var custoCompra = carneQnt * compras

        lucro = (carneQnt * vendas) - (carneQnt * compras);
        lucroPerda = lucro - lucroAfetado
        
        if (perda === 0.5) {
            lucroPerda = custoCompra;  // Prejuízo total é o custo de compra
            lucro = 0;  // Não há mais lucro
        }

        // alterando o style da div "botaoDiv" -> ela vai para o display: "none", ou seja, some.
        botaoDiv.style.display = "none";

        div_resp.innerHTML += `
            <p style="text-align: justify; line-height: 1.6;">
                A carne ficou exposta a uma temperatura de <br>
                <b>${temperatura}°C</b> por <b>${horas}</b> horas.<br><br>

                De acordo com o tempo fora da temperatura segura <br>
                (que normalmente é de <b>-3°C a 4°C</b>), <br>
                aplicamos uma taxa de deterioração de <b>${perda * 100}%</b>.<br><br>

                ${perda === 0.5 ? `Devido à deterioração extrema, o lote não poderá ser vendido,
                resultando em uma perda total de <b>R$${lucroPerda.toFixed(2)}</b>, equivalente ao valor de compra do lote.` 
                : `Isso significa que a carne perderá <b>${perda * 100}%</b> de seu valor de venda por peça.<br><br>
                Como resultado, a perda estimada no lucro total do lote será de <b>R$${lucroAfetado.toFixed(2)}</b>,
                 considerando que o lucro original seria de <b>R$${lucro.toFixed(2)}</b>.<br>
                 <b>Lucro final: R$${lucroPerda}</b>`
                }
            </p>
`;

    }
</script>

</html>