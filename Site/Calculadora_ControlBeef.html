<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora</title>
</head>

<body>
    <div class="container-pai-pai">
        <H1>Calcule a sua possível perda</H1>
        <div class="container-pai">
            <div class="container">
                <input type="text" id="ipt_carneInfo" placeholder="Insira a carne do lote..."> <br><br>
                <input type="number" id="ipt_carneQnt" placeholder="Insira a quantidade de carne (kg)..."> <br><br>
                <input type="number" id="ipt_precoV" placeholder="Insira o preço de venda da carne..."> <br><br>
                <input type="number" id="ipt_precoC" placeholder="Insira o preço pelo qual foi comprado a carne..."> <br><br>
                <div class="container-inad">
                    <input type="number" id="ipt_temp" placeholder="Insira a temperatura que a carne ficou..."> <br><br>
                    <input type="number" id="ipt_hora"
                        placeholder="Insira a quantidade de horas que a carne ficou nessa temperatura..."> <br><br>
                </div>
                <button onclick="Calcular()">Calcular perda</button> <br><br>
            </div>
            <div id="div_resp" style="background-color: #f9f9f9;"><span>Esperando dados...</span></div> 
        </div>
    </div>
</body>
<script>
    var lucroPerda = lucro * perda
    var lucroAfetado = lucro - lucroPerda
    var perda = 0;
    var lucro = 0

    function Calcular() {

        var carne = (ipt_carneInfo.value)
        var carneQnt = Number(ipt_carneQnt.value)
        var temperatura = Number(ipt_temp.value)
        var horas = Number(ipt_hora.value)
        var vendas = Number(ipt_precoV.value)
        var compras = Number(ipt_precoC.value)
        lucro = (carneQnt * vendas) - (carneQnt * compras)
        // Máxima temperatura segura 4ºC
        // Mínima temperatura segura -3 para refrigeração, dps ela congela

        if (temperatura >= -3 && temperatura <= 4) {
            div_resp.innerHTML = `<p>O lote de ${carne} não sofrerá perdas dentro de 12 meses</p>`;
        }

        if (temperatura >= 4) {
            if (horas >= 0 && horas <= 2) {
                var tempoRest = 2 - horas
                perda = 0
                div_resp.innerHTML = ` <p>O lote de ${carne} não sofrerá perdas dentro de ${tempoRest} horas</p>`
            } else if (horas <= 4) {
                perda = 0.02
            } else if (horas <= 8) {
                perda = 0.1
            } else if (horas <= 12) {
                perda = 0.2
            } else if (horas <= 24) {
                perda = 0.35
            } else {
                perda = 0.5
            }

            if (perda > 0) {
                lucroPerda = lucro * perda
                lucroAfetado = lucro - lucroPerda

                div_resp.innerHTML = `<p><b>Você perderá R$${lucroPerda.toFixed(2)}.</b></p>`

                if (perda === 0.5) {
                    div_resp.innerHTML += `<p>
                        O lote de ${carne} poderá ir para processamento ou
                        apenas será descartado dependendo da situação
                        </p>`;
                }

                div_resp.innerHTML += `<button id="botaoDiv" onclick="VerMais()">Ver Mais</button>`
            }
        } else if (temperatura < -3) {
            if (horas >= 0 && horas <= 2) {
                var tempoRest = 2 - horas
                console.log(tempoRest)
                perda = 0
                div_resp.innerHTML = ` <p>O lote de ${carne} não sofrerá perdas dentro de ${tempoRest} horas</p>`
            } else if (horas <= 23) {
                perda = 0.03
            } else if (horas <= 47) {
                perda = 0.07
            } else {
                perda = 0.15
                div_resp.innerHTML = `<p>O lote de ${carne} poderá ir para o uso industrial (imbutidos ou moída)</p>`
            }
            if (perda > 0) {
                lucroPerda = lucro * perda
                lucroAfetado = lucro - lucroPerda
                div_resp.innerHTML = `<p><b>Você perderá R$${lucroPerda.toFixed(2)}.</b></p>`

                if (perda === 0.15) {
                    div_resp.innerHTML += `<p>O lote de ${carne} poderá ir para o uso industrial (embutidos ou moída)</p>`;
                }

                div_resp.innerHTML += `<button id="botaoDiv" onclick="VerMais()">Ver Mais</button>`
            }
        }
    }

    function VerMais() {
        var carne = (ipt_carneInfo.value)
        var carneQnt = Number(ipt_carneQnt.value)
        var temperatura = Number(ipt_temp.value)
        var horas = Number(ipt_hora.value)
        var vendas = Number(ipt_precoV.value)
        var compras = Number(ipt_precoC.value)

        lucro = (carneQnt * vendas) - (carneQnt * compras)

        // alterando o style da div "botaoDiv" -> ela vai para o display: "none", ou seja, some.
        botaoDiv.style.display = "none";

        div_resp.innerHTML += `
    <p style="text-align: justify; line-height: 1.6;">
        A carne ficou exposta a uma temperatura de <br>
        <b>${temperatura}°C</b> por <b>${horas}</b> horas.<br><br>

        De acordo com o tempo fora da temperatura segura <br>
        (que normalmente é de <b>-3°C a 4°C</b>), <br>
        aplicamos uma taxa de deterioração de <b>${perda * 100}%</b>.<br><br>

        Isso significa que a carne perderá <b>${perda * 100}%</b> de seu valor.<br><br>

        Como resultado, a perda estimada no lucro total do lote será de
        <b>R$${lucroPerda.toFixed(2)}</b>, considerando que o lucro original seria de
        <b>R$${lucro.toFixed(2)}</b>.
    </p>
`;


    }
</script>

</html>