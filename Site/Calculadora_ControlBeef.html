<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora</title>
</head>

<body>
    <div>
        <H1>Calcule a sua possível perda</H1>
        <div>
            <div>
                <p>Insira a carne do seu lote</p>
                <input type="text" id="ipt_carneInfo" placeholder="Insira a carne do lote..."> <br>
                <p>Insira a quantidade de carne (kg)</p>
                <input type="number" id="ipt_carneQnt" placeholder="Insira a quantidade de carne (kg)..."> <br>
                <p>Insira o preço de venda da carne</p>
                <input type="number" id="ipt_precoV" placeholder="Insira o preço de venda da carne..."> <br>
                <p>Insira o preço pelo qual foi comprado a carne</p>
                <input type="number" id="ipt_precoC" placeholder="Insira o preço pelo qual foi comprado a carne...">
                <br>
                <div>
                    <p>Insira a temperatura que a carne ficou armazenada</p>
                    <input type="number" id="ipt_temp" placeholder="Insira a temperatura que a carne ficou..."> <br>
                    <p>Insira a quantidade de horas que a carne ficou nessa temperatura</p>
                    <input type="number" id="ipt_hora"
                        placeholder="Insira a quantidade de horas que a carne ficou nessa temperatura..."> <br><br>
                </div>
                <button onclick="Calcular()">Calcular perda</button> <br><br>
            </div>
            <div id="div_resp" style="background-color: #f9f9f9;"><span>Esperando dados...</span></div>
        </div>
    </div>
</body>
<script>
    var perda = 0;
    var lucro = 0;
    var lucroPerda = lucro * perda;
    var lucroAfetado = lucro - lucroPerda;

    function Calcular() {
        var carne = (ipt_carneInfo.value);
        var carneQnt = Number(ipt_carneQnt.value);
        var temperatura = Number(ipt_temp.value);
        var horas = Number(ipt_hora.value);
        var vendas = Number(ipt_precoV.value);
        var compras = Number(ipt_precoC.value);
        var perdaVendas = 0;
        var perdaCompras = 0;
        var receitaBruta = carneQnt * vendas;
        var custoCompra = carneQnt * compras;
        lucro = receitaBruta - custoCompra;

        // Se a temperatura estiver entre -3°C e 4°C, não há perdas dentro de 12 meses
        if (temperatura >= -3 && temperatura <= 4) {
            div_resp.innerHTML = `<p>O lote de ${carne} não sofrerá perdas dentro de 12 meses</p>`;
        }

        // Se a temperatura for superior a 4°C
        if (temperatura > 4) {
            if (horas >= 0 && horas <= 2) {
                // Até 2 horas → Sem perdas
                var tempoRest = 2 - horas;
                perda = 0;
                div_resp.innerHTML = `<p>O lote de ${carne} não sofrerá perdas dentro de ${tempoRest} horas</p>`;
            } else if (horas <= 4) {
                // 2 - 4 horas → 2% de perda
                perda = 0.02;
            } else if (horas <= 8) {
                // 4 - 8 horas → 10% de perda
                perda = 0.1;
            } else if (horas <= 12) {
                // 8 - 12 horas → 20% de perda
                perda = 0.2;
            } else if (horas <= 24) {
                // 12 - 24 horas → 35% de perda
                perda = 0.35;
            } else {
                // Acima de 24 horas → 50% de perda (lote inutilizável)
                perda = 0.5;
            }
        }

        // Se a temperatura for inferior a -3°C
        else if (temperatura < -3) {
            if (horas >= 0 && horas <= 2) {
                // Até 2 horas → Sem perdas
                var tempoRest = 2 - horas;
                console.log(tempoRest);
                perda = 0;
                div_resp.innerHTML = `<p>O lote de ${carne} não sofrerá perdas dentro de ${tempoRest} horas</p>`;
            } else if (horas <= 23) {
                // Até 23 horas → 3% de perda
                perda = 0.03;
            } else if (horas <= 47) {
                // Até 47 horas → 7% de perda
                perda = 0.07;
            } else {
                // Acima de 47 horas → 15% de perda
                perda = 0.15;
            }
        }

        if (perda > 0) {
            perdaVendas = perda * vendas;
            perdaCarne = (vendas - perdaVendas) * carneQnt;
            lucroPerda = perdaCarne - custoCompra;
            lucroAfetado = lucro - lucroPerda;

            div_resp.innerHTML = `<p><b>Cada carne custará R$${perdaVendas.toFixed(2)} a menos na venda para o consumidor.
                Resultando em uma perda de R$${lucroAfetado.toFixed(2)} no lucro final.</b></p>`;

            if (perda === 0.5) {
                lucroAfetado = custoCompra;
                div_resp.innerHTML = `<p><b>O lote de ${carne} não poderá mais ser comercializado,
                    podendo ir apenas para processamento ou apenas será descartado. <br>
                    Resultando em uma perda total de <span style="color: red;">R$${lucroAfetado}.</span></b> <br>`;
            }

            if (perda === 0.15) {
                div_resp.innerHTML += `<p><b><p>O lote de ${carne} poderá ir para o uso industrial (embutidos ou moída)</p></b> <br>`;
            }

            div_resp.innerHTML += `<button id="botaoDiv" onclick="VerMais()">Ver Mais</button>`;
        }
    }
</script>


</html>